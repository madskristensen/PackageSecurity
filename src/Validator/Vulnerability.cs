using System.Collections.Generic;
using System.Linq;
using Newtonsoft.Json;

namespace PackageSecurity
{
    public class Vulnerability
    {
        [JsonProperty("atOrAbove")]
        public string AtOrAbove { get; set; }

        [JsonProperty("below")]
        public string Below { get; set; }

        [JsonProperty("severity")]
        public VulnerabilityLevel Severity { get; set; }

        [JsonProperty("info")]
        public IEnumerable<string> Info { get; set; }

        private static Vulnerability _empty;
        public static Vulnerability Empty
        {
            get
            {
                if (_empty == null)
                {
                    _empty = new Vulnerability
                    {
                        Severity = VulnerabilityLevel.None,
                        Info = Enumerable.Empty<string>()
                    };
                }

                return _empty;
            }
        }
    }
}
